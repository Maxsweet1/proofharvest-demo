<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProofHarvest Demo - Create & Manage Smart Escrows</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const ProofHarvestDemo = () => {
          const [account, setAccount] = useState(null);
          const [connected, setConnected] = useState(false);
          const [currentView, setCurrentView] = useState('dashboard'); // 'dashboard' or 'create'
          const [escrows, setEscrows] = useState([
            {
              id: "1",
              buyer: "0x1234567890123456789012345678901234567890",
              seller: "0x9876543210987654321098765432109876543210",
              amount: "2500.00",
              released: "1000.00",
              remaining: "1500.00",
              status: "InProgress",
              currentMilestone: 1,
              lastUpdated: "2025-05-09T14:30:00Z",
              milestones: [
                { percentage: 40, amount: "1000.00", description: "Harvest completion", completed: true, completedAt: "2025-05-09T14:30:00Z" },
                { percentage: 30, amount: "750.00", description: "Quality inspection passed", completed: false },
                { percentage: 30, amount: "750.00", description: "Delivery confirmation", completed: false }
              ]
            }
          ]);
          
          // New escrow form state
          const [newEscrow, setNewEscrow] = useState({
            buyerAddress: '',
            sellerAddress: '',
            totalAmount: '',
            milestones: [
              { percentage: 50, description: 'Initial milestone' },
              { percentage: 50, description: 'Final milestone' }
            ]
          });
          
          const [transactionPending, setTransactionPending] = useState(false);
          const [notification, setNotification] = useState(null);
          const [showHistory, setShowHistory] = useState(false);
          const [showFilter, setShowFilter] = useState("all");
          const [filteredEscrows, setFilteredEscrows] = useState(escrows);
          
          const [transactionHistory, setTransactionHistory] = useState([
            {
              escrowId: "1",
              action: "Milestone Completion",
              milestone: 1,
              amount: "1000.00",
              timestamp: "2025-05-09T14:30:00Z"
            },
            {
              escrowId: "1",
              action: "Escrow Funded",
              amount: "2500.00",
              timestamp: "2025-05-05T10:15:00Z"
            }
          ]);
          
          useEffect(() => {
            if (showFilter === "all") {
              setFilteredEscrows(escrows);
            } else if (showFilter === "buyer") {
              setFilteredEscrows(escrows.filter(escrow => 
                account && escrow.buyer.toLowerCase() === account.toLowerCase()
              ));
            } else if (showFilter === "seller") {
              setFilteredEscrows(escrows.filter(escrow => 
                account && escrow.seller.toLowerCase() === account.toLowerCase()
              ));
            }
          }, [showFilter, escrows, account]);
          
          const connectWallet = () => {
            setTransactionPending(true);
            setTimeout(() => {
              setAccount("0x1234567890123456789012345678901234567890");
              setConnected(true);
              setTransactionPending(false);
              showNotification("Wallet connected successfully!");
            }, 1500);
          };
          
          const showNotification = (message, type = "success") => {
            setNotification({ message, type });
            setTimeout(() => setNotification(null), 5000);
          };
          
          const formatAddress = (address) => {
            if (!address) return '';
            return `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
          };
          
          const formatDate = (timestamp) => {
            const date = new Date(timestamp);
            return date.toLocaleString();
          };

          // Add milestone to new escrow
          const addMilestone = () => {
            setNewEscrow(prev => ({
              ...prev,
              milestones: [...prev.milestones, { percentage: 0, description: '' }]
            }));
          };

          // Remove milestone from new escrow
          const removeMilestone = (index) => {
            if (newEscrow.milestones.length > 1) {
              setNewEscrow(prev => ({
                ...prev,
                milestones: prev.milestones.filter((_, i) => i !== index)
              }));
            }
          };

          // Update milestone in new escrow
          const updateMilestone = (index, field, value) => {
            setNewEscrow(prev => ({
              ...prev,
              milestones: prev.milestones.map((milestone, i) => 
                i === index ? { ...milestone, [field]: value } : milestone
              )
            }));
          };

          // Calculate total percentage
          const getTotalPercentage = () => {
            return newEscrow.milestones.reduce((sum, milestone) => sum + (parseFloat(milestone.percentage) || 0), 0);
          };

          // Create new escrow
          const createEscrow = () => {
            // Validation
            if (!newEscrow.buyerAddress || !newEscrow.sellerAddress || !newEscrow.totalAmount) {
              showNotification("Please fill in all required fields", "error");
              return;
            }

            if (getTotalPercentage() !== 100) {
              showNotification("Milestone percentages must total 100%", "error");
              return;
            }

            if (newEscrow.milestones.some(m => !m.description.trim())) {
              showNotification("Please provide descriptions for all milestones", "error");
              return;
            }

            setTransactionPending(true);
            
            setTimeout(() => {
              const newId = (Math.max(...escrows.map(e => parseInt(e.id))) + 1).toString();
              const totalAmount = parseFloat(newEscrow.totalAmount);
              
              const milestonesWithAmounts = newEscrow.milestones.map(milestone => ({
                ...milestone,
                percentage: parseFloat(milestone.percentage),
                amount: ((parseFloat(milestone.percentage) / 100) * totalAmount).toFixed(2),
                completed: false
              }));

              const createdEscrow = {
                id: newId,
                buyer: newEscrow.buyerAddress,
                seller: newEscrow.sellerAddress,
                amount: totalAmount.toFixed(2),
                released: "0.00",
                remaining: totalAmount.toFixed(2),
                status: "Created",
                currentMilestone: 0,
                lastUpdated: new Date().toISOString(),
                milestones: milestonesWithAmounts
              };

              setEscrows(prev => [...prev, createdEscrow]);
              
              // Add to transaction history
              const newTransaction = {
                escrowId: newId,
                action: "Escrow Created",
                timestamp: new Date().toISOString()
              };
              setTransactionHistory(prev => [newTransaction, ...prev]);

              // Reset form
              setNewEscrow({
                buyerAddress: '',
                sellerAddress: '',
                totalAmount: '',
                milestones: [
                  { percentage: 50, description: 'Initial milestone' },
                  { percentage: 50, description: 'Final milestone' }
                ]
              });

              setTransactionPending(false);
              setCurrentView('dashboard');
              showNotification(`New escrow created successfully! ID: ${newId}`);
            }, 2000);
          };

          // Handle completing a milestone
          const handleCompleteMilestone = (escrowId, milestoneIndex) => {
            setTransactionPending(true);
            
            setTimeout(() => {
              const updatedEscrows = [...escrows];
              const index = updatedEscrows.findIndex(e => e.id === escrowId);
              
              if (index !== -1) {
                const escrow = updatedEscrows[index];
                
                if (milestoneIndex < escrow.milestones.length && !escrow.milestones[milestoneIndex].completed) {
                  const milestone = escrow.milestones[milestoneIndex];
                  
                  milestone.completed = true;
                  milestone.completedAt = new Date().toISOString();
                  
                  const releasedAmount = parseFloat(escrow.released) + parseFloat(milestone.amount);
                  escrow.released = releasedAmount.toFixed(2);
                  escrow.remaining = (parseFloat(escrow.amount) - releasedAmount).toFixed(2);
                  
                  let nextMilestone = 0;
                  while (nextMilestone < escrow.milestones.length && escrow.milestones[nextMilestone].completed) {
                    nextMilestone++;
                  }
                  escrow.currentMilestone = nextMilestone;
                  
                  escrow.lastUpdated = new Date().toISOString();
                  
                  if (escrow.milestones.every(m => m.completed)) {
                    escrow.status = "Completed";
                  } else if (escrow.status === "Created") {
                    escrow.status = "InProgress";
                  }
                  
                  const newTransaction = {
                    escrowId: escrowId,
                    action: "Milestone Completion",
                    milestone: milestoneIndex + 1,
                    amount: milestone.amount,
                    timestamp: new Date().toISOString()
                  };
                  
                  setTransactionHistory(prev => [newTransaction, ...prev]);
                }
              }
              
              setEscrows(updatedEscrows);
              setTransactionPending(false);
              showNotification(`Milestone ${milestoneIndex + 1} completed! ${escrow.milestones[milestoneIndex].amount} USDC released.`);
            }, 2000);
          };
          
          // Handle funding an escrow
          const handleFundEscrow = (escrowId) => {
            setTransactionPending(true);
            
            setTimeout(() => {
              const updatedEscrows = [...escrows];
              const index = updatedEscrows.findIndex(e => e.id === escrowId);
              
              if (index !== -1) {
                updatedEscrows[index].status = "Funded";
                updatedEscrows[index].lastUpdated = new Date().toISOString();
                
                const newTransaction = {
                  escrowId: escrowId,
                  action: "Escrow Funded",
                  amount: updatedEscrows[index].amount,
                  timestamp: new Date().toISOString()
                };
                
                setTransactionHistory(prev => [newTransaction, ...prev]);
              }
              
              setEscrows(updatedEscrows);
              setTransactionPending(false);
              showNotification(`Escrow #${escrowId} funded successfully!`);
            }, 2000);
          };

          // Render create escrow form
          const renderCreateForm = () => {
            const totalPercentage = getTotalPercentage();
            const isValidPercentage = totalPercentage === 100;

            return React.createElement('div', {className: "bg-white rounded-lg shadow p-6"},
              React.createElement('div', {className: "flex items-center justify-between mb-6"},
                React.createElement('h2', {className: "text-2xl font-bold text-green-700"}, "Create New Escrow Agreement"),
                React.createElement('button', {
                  onClick: () => setCurrentView('dashboard'),
                  className: "text-gray-500 hover:text-gray-700"
                }, "← Back to Dashboard")
              ),

              React.createElement('div', {className: "grid grid-cols-1 md:grid-cols-2 gap-6"},
                // Left column - Basic Info
                React.createElement('div', {},
                  React.createElement('h3', {className: "text-lg font-semibold mb-4"}, "Agreement Details"),
                  
                  React.createElement('div', {className: "mb-4"},
                    React.createElement('div', {className: "flex items-center justify-between mb-2"},
                      React.createElement('label', {className: "block text-sm font-medium text-gray-700"}, "Buyer Address"),
                      React.createElement('button', {
                        onClick: () => setNewEscrow(prev => ({...prev, buyerAddress: "0x742d35Cc891bA7B7c9d7c4c9BF24b87b38a4D8c3"})),
                        className: "text-xs text-blue-600 hover:text-blue-800"
                      }, "Use Sample")
                    ),
                    React.createElement('input', {
                      type: "text",
                      value: newEscrow.buyerAddress,
                      onChange: (e) => setNewEscrow(prev => ({...prev, buyerAddress: e.target.value})),
                      placeholder: "0x... or click 'Use Sample'",
                      className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                    })
                  ),

                  React.createElement('div', {className: "mb-4"},
                    React.createElement('div', {className: "flex items-center justify-between mb-2"},
                      React.createElement('label', {className: "block text-sm font-medium text-gray-700"}, "Seller Address"),
                      React.createElement('button', {
                        onClick: () => setNewEscrow(prev => ({...prev, sellerAddress: "0x8f9e3B2A1c0d7F5e4A6c8B9d2E1f3A4b5C6d7E8f"})),
                        className: "text-xs text-blue-600 hover:text-blue-800"
                      }, "Use Sample")
                    ),
                    React.createElement('input', {
                      type: "text",
                      value: newEscrow.sellerAddress,
                      onChange: (e) => setNewEscrow(prev => ({...prev, sellerAddress: e.target.value})),
                      placeholder: "0x... or click 'Use Sample'",
                      className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                    })
                  ),

                  React.createElement('div', {className: "mb-4"},
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Total Amount (USDC)"),
                    React.createElement('input', {
                      type: "number",
                      value: newEscrow.totalAmount,
                      onChange: (e) => setNewEscrow(prev => ({...prev, totalAmount: e.target.value})),
                      placeholder: "e.g. 5000",
                      className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",
                      min: "0",
                      step: "0.01"
                    })
                  ),

                  // Quick start helper
                  React.createElement('div', {className: "mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},
                    React.createElement('p', {className: "text-sm text-blue-700 mb-2"}, "💡 Quick Demo: Click the button below to auto-fill with sample data"),
                    React.createElement('button', {
                      onClick: () => {
                        setNewEscrow({
                          buyerAddress: "0x742d35Cc891bA7B7c9d7c4c9BF24b87b38a4D8c3",
                          sellerAddress: "0x8f9e3B2A1c0d7F5e4A6c8B9d2E1f3A4b5C6d7E8f",
                          totalAmount: "5000",
                          milestones: [
                            { percentage: 30, description: 'Project planning & setup' },
                            { percentage: 40, description: 'Harvest completion' },
                            { percentage: 30, description: 'Quality inspection & delivery' }
                          ]
                        });
                      },
                      className: "px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700"
                    }, "🚀 Fill Sample Data")
                  )
                ),

                // Right column - Milestones
                React.createElement('div', {},
                  React.createElement('div', {className: "flex items-center justify-between mb-4"},
                    React.createElement('h3', {className: "text-lg font-semibold"}, "Milestones"),
                    React.createElement('div', {className: `text-sm font-medium ${isValidPercentage ? 'text-green-600' : 'text-red-600'}`},
                      `Total: ${totalPercentage}%`
                    )
                  ),

                  newEscrow.milestones.map((milestone, index) =>
                    React.createElement('div', {key: index, className: "mb-4 p-3 border border-gray-200 rounded-lg"},
                      React.createElement('div', {className: "flex items-center justify-between mb-2"},
                        React.createElement('span', {className: "font-medium text-sm"}, `Milestone ${index + 1}`),
                        newEscrow.milestones.length > 1 && 
                          React.createElement('button', {
                            onClick: () => removeMilestone(index),
                            className: "text-red-500 hover:text-red-700 text-sm"
                          }, "Remove")
                      ),

                      React.createElement('div', {className: "mb-2"},
                        React.createElement('label', {className: "block text-xs text-gray-600 mb-1"}, "Percentage"),
                        React.createElement('input', {
                          type: "number",
                          value: milestone.percentage || '',
                          onChange: (e) => updateMilestone(index, 'percentage', parseFloat(e.target.value) || 0),
                          className: "w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-green-500",
                          min: "0",
                          max: "100",
                          placeholder: "0"
                        })
                      ),

                      React.createElement('div', {},
                        React.createElement('label', {className: "block text-xs text-gray-600 mb-1"}, "Description"),
                        React.createElement('input', {
                          type: "text",
                          value: milestone.description || '',
                          onChange: (e) => updateMilestone(index, 'description', e.target.value),
                          placeholder: "Enter milestone description",
                          className: "w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-green-500"
                        })
                      ),

                      newEscrow.totalAmount && milestone.percentage > 0 &&
                        React.createElement('div', {className: "text-xs text-gray-500 mt-1"},
                          `Amount: ${((parseFloat(milestone.percentage) / 100) * parseFloat(newEscrow.totalAmount || 0)).toFixed(2)} USDC`
                        )
                    )
                  ),

                  React.createElement('button', {
                    onClick: addMilestone,
                    className: "w-full mb-4 px-3 py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-green-500 hover:text-green-600 text-sm"
                  }, "+ Add Milestone")
                )
              ),

              React.createElement('div', {className: "mt-6 flex justify-end space-x-4"},
                React.createElement('button', {
                  onClick: () => setCurrentView('dashboard'),
                  className: "px-4 py-2 text-gray-600 hover:text-gray-800"
                }, "Cancel"),
                React.createElement('button', {
                  onClick: createEscrow,
                  disabled: !isValidPercentage || transactionPending || !newEscrow.buyerAddress || !newEscrow.sellerAddress || !newEscrow.totalAmount,
                  className: "px-6 py-2 bg-green-700 text-white rounded-lg font-medium hover:bg-green-800 disabled:bg-gray-400 disabled:cursor-not-allowed"
                }, transactionPending ? 'Creating...' : 'Create Escrow')
              )
            );
          };

          // Render dashboard
          const renderDashboard = () => {
            return React.createElement('div', {},
              React.createElement('div', {className: "flex items-center justify-between mb-6"},
                React.createElement('h2', {className: "text-2xl font-bold text-green-700"}, "Your Escrow Agreements"),
                React.createElement('button', {
                  onClick: () => setCurrentView('create'),
                  className: "bg-green-700 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-800"
                }, "+ Create New Escrow")
              ),

              React.createElement('div', {className: "grid grid-cols-1 md:grid-cols-2 gap-6"},
                filteredEscrows.map(escrow =>
                  React.createElement('div', {key: escrow.id, className: "border border-gray-200 rounded-lg shadow-sm p-4"},
                    React.createElement('div', {className: "flex justify-between items-start mb-2"},
                      React.createElement('div', {className: "text-gray-500 text-sm font-mono"}, `ID: ${escrow.id}`),
                      React.createElement('div', {className: `text-xs font-medium px-2 py-1 rounded-full ${
                        escrow.status === 'Created' ? 'bg-gray-100 text-gray-700' :
                        escrow.status === 'Funded' ? 'bg-blue-100 text-blue-700' :
                        escrow.status === 'InProgress' ? 'bg-yellow-100 text-yellow-700' :
                        escrow.status === 'Completed' ? 'bg-green-100 text-green-700' :
                        'bg-red-100 text-red-700'
                      }`}, escrow.status)
                    ),
                    
                    React.createElement('div', {className: "mb-4"},
                      React.createElement('div', {className: "text-2xl font-bold"}, `${escrow.amount} USDC`),
                      React.createElement('div', {className: "flex flex-wrap items-center text-sm mt-1"},
                        React.createElement('div', {className: `mr-3 font-medium ${parseFloat(escrow.released) > 0 ? 'text-green-600' : 'text-gray-500'}`},
                          `Released: ${escrow.released} USDC`,
                          parseFloat(escrow.released) > 0 && 
                            React.createElement('span', {className: "ml-1"}, 
                              `(${((parseFloat(escrow.released) / parseFloat(escrow.amount)) * 100).toFixed(0)}%)`
                            )
                        ),
                        React.createElement('div', {className: `font-medium ${parseFloat(escrow.remaining) > 0 ? 'text-blue-600' : 'text-gray-500'}`},
                          `In Escrow: ${escrow.remaining} USDC`
                        )
                      )
                    ),
                    
                    React.createElement('div', {className: "text-sm mb-4"},
                      React.createElement('div', {className: "mb-1"},
                        React.createElement('span', {className: "text-gray-500 font-medium"}, "Buyer: "),
                        React.createElement('span', {className: "bg-gray-100 px-1 py-0.5 rounded font-mono text-xs"}, formatAddress(escrow.buyer))
                      ),
                      React.createElement('div', {},
                        React.createElement('span', {className: "text-gray-500 font-medium"}, "Seller: "),
                        React.createElement('span', {className: "bg-gray-100 px-1 py-0.5 rounded font-mono text-xs"}, formatAddress(escrow.seller))
                      )
                    ),
                    
                    React.createElement('div', {className: "mb-4"},
                      React.createElement('div', {className: "font-medium text-sm mb-2"}, "Milestones:"),
                      escrow.milestones.map((milestone, index) =>
                        React.createElement('div', {
                          key: index,
                          className: `border-l-4 pl-3 py-2 mb-2 ${
                            milestone.completed 
                              ? 'border-green-500 bg-green-50' 
                              : 'border-gray-300 bg-gray-50'
                          }`
                        },
                          React.createElement('div', {className: "flex justify-between text-sm mb-1"},
                            React.createElement('div', {},
                              `${milestone.completed ? '✓ ' : ''}Milestone ${index + 1}`
                            ),
                            React.createElement('div', {className: "font-medium"},
                              `${milestone.percentage}% (${milestone.amount} USDC)`
                            )
                          ),
                          React.createElement('div', {className: "text-sm text-gray-600"}, milestone.description),
                          milestone.completed && 
                            React.createElement('div', {className: "text-xs text-green-600 mt-1"}, 
                              `Completed on ${formatDate(milestone.completedAt)}`
                            )
                        )
                      )
                    ),
                    
                    React.createElement('div', {className: "mt-4"},
                      escrow.status === 'Created' && 
                        React.createElement('button', {
                          className: "bg-green-700 text-white px-4 py-2 rounded font-medium hover:bg-green-800 disabled:bg-gray-400 w-full mb-2",
                          disabled: transactionPending,
                          onClick: () => handleFundEscrow(escrow.id)
                        }, transactionPending ? 'Processing...' : 'Fund Escrow'),
                      
                      (escrow.status === 'Funded' || escrow.status === 'InProgress') && 
                       escrow.milestones.some(m => !m.completed) && 
                        React.createElement('div', {className: "space-y-2"},
                          React.createElement('div', {className: "text-xs font-medium text-gray-600"}, "Complete milestone:"),
                          React.createElement('div', {className: "flex flex-wrap gap-1"},
                            escrow.milestones.map((milestone, index) => {
                              if (milestone.completed) return null;
                              
                              return React.createElement('button', {
                                key: index,
                                onClick: () => handleCompleteMilestone(escrow.id, index),
                                disabled: transactionPending,
                                className: "text-xs bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded disabled:bg-gray-400"
                              }, `#${index + 1}: ${milestone.percentage}%`);
                            })
                          )
                        )
                    )
                  )
                )
              ),
              
              React.createElement('div', {className: "mt-6 flex justify-center space-x-4"},
                React.createElement('button', {
                  className: `px-3 py-1 rounded text-sm font-medium ${showFilter === 'all' ? 'bg-green-700 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,
                  onClick: () => setShowFilter('all')
                }, "All Escrows"),
                React.createElement('button', {
                  className: `px-3 py-1 rounded text-sm font-medium ${showFilter === 'buyer' ? 'bg-green-700 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,
                  onClick: () => setShowFilter('buyer')
                }, "As Buyer"),
                React.createElement('button', {
                  className: `px-3 py-1 rounded text-sm font-medium ${showFilter === 'seller' ? 'bg-green-700 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,
                  onClick: () => setShowFilter('seller')
                }, "As Seller")
              )
            );
          };

          return React.createElement('div', {className: "bg-gray-100 min-h-screen"},
            React.createElement('div', {className: "max-w-6xl mx-auto px-4 py-8"},
              // Prototype Notice
              React.createElement('div', {className: "bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-lg mb-6"},
                React.createElement('div', {className: "flex items-center"},
                  React.createElement('svg', {className: "h-5 w-5 mr-2", fill: "currentColor", viewBox: "0 0 20 20"},
                    React.createElement('path', {fillRule: "evenodd", d: "M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z", clipRule: "evenodd"})
                  ),
                  React.createElement('div', {},
                    React.createElement('p', {className: "font-medium"}, "Interactive Demo – Create & Test Escrow Agreements"),
                    React.createElement('p', {className: "text-sm"}, "Full-featured simulation showing the complete ProofHarvest workflow.")
                  )
                )
              ),

              // Header
              React.createElement('header', {className: "bg-green-700 text-white p-6 rounded-lg mb-8 text-center"},
                React.createElement('div', {className: "text-2xl font-bold mb-2"}, "🌱 ProofHarvest"),
                React.createElement('h1', {className: "text-xl mb-4"}, "Milestone-Based Smart Escrow for Ethical Agriculture"),
                
                React.createElement('div', {className: "flex justify-center"},
                  !connected ? 
                    React.createElement('button', {
                      onClick: connectWallet,
                      className: "bg-white text-green-700 px-4 py-2 rounded font-medium hover:bg-gray-100",
                      disabled: transactionPending
                    }, transactionPending ? 'Connecting...' : 'Connect Wallet') :
                    React.createElement('div', {className: "flex items-center bg-green-800 px-4 py-2 rounded"},
                      React.createElement('div', {className: "mr-2"}, "Connected:"),
                      React.createElement('div', {className: "bg-green-600 px-2 py-1 rounded font-mono text-sm"},
                        formatAddress(account)
                      )
                    )
                )
              ),

              // Main Content
              React.createElement('main', {className: "mb-8"},
                !connected ? 
                  React.createElement('div', {className: "bg-white rounded-lg shadow p-6 text-center py-12 text-gray-500"},
                    React.createElement('p', {className: "text-lg"}, "Connect your wallet to create and manage escrow agreements")
                  ) :
                  currentView === 'create' ? renderCreateForm() : renderDashboard()
              ),
              
              // Transaction notification
              notification && 
                React.createElement('div', {className: `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                  notification.type === 'error' ? 'bg-red-100 text-red-700 border-l-4 border-red-500' : 
                  'bg-green-100 text-green-700 border-l-4 border-green-500'
                }`}, notification.message),
              
              // Loading overlay
              transactionPending && 
                React.createElement('div', {className: "fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50"},
                  React.createElement('div', {className: "bg-white p-6 rounded-lg shadow-xl flex flex-col items-center"},
                    React.createElement('div', {className: "animate-spin rounded-full h-12 w-12 border-b-2 border-green-700 mb-4"}),
                    React.createElement('p', {className: "text-gray-700"}, "Processing transaction..."),
                    React.createElement('p', {className: "text-xs text-gray-500 mt-2"}, "(Simulated for demo purposes)")
                  )
                ),
              
              // Footer
              React.createElement('footer', {className: "text-center text-gray-500 text-sm mt-8"},
                React.createElement('p', {}, "© 2025 GTL Labs - ProofHarvest"),
                React.createElement('p', {className: "text-xs mt-1"}, "Full-Featured Demo - Create, Fund & Manage Escrows")
              )
            )
          );
        };

        ReactDOM.render(React.createElement(ProofHarvestDemo), document.getElementById('root'));
    </script>
</body>
</html>
